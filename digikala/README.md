### Routes

`/api/` | method: POST | accept: json

request body:

```json
{
  "url": "a digikala page url"
}
```

---

### Models:

    Digikala:
      fields:
        - product_id
        - category
        - title
        - brand
        - price
        - off
        - url

---

    Laptop(Digikala):
        fields:
            cpu_manifacturer cpu_serry cpu_model ram_capacity ram_type
            gpu_manifacturer gpu_model internal_sotrage_type size resolution
            optical_drive connection_ports usb2 usb3 battery

---

    Mobile(Digikala):
        ram cpu size resolution storage network
        main_camera selfie_camera battery

---

<font dir="rtl">

### مدل ها

مدل Digikala برای نگه داشتن فیلد های مشترک بین محصولات. این کار باعث کد نویسی کمتر و تمیزتر میشه
مدل Laptop و Mobile از Digikala ارث بری کردن

---

### پکیج api_digikala

این پکیج رو خودم ساختم. کارش اینه که میاد از api سایت دیجی کالا اطلاعات هر صفحه رو دریافت میکنه. آدرس اصلی api سایت دیجی کالا api.digikala.com/v1/ هستش
این پکیج از برنامه اصلی مستقله و برای گرفتن محصولات هر صفحه استفاده میشه

#### طرز کار

</font>

```python
from api_digikala import get_url_clean_data

url = "a digikala page url"
data = get_url_clean_data(url)
```

<font dir="rtl">

توابع دیگه‌ای هم داره که میشه فقط آیدی یه محصول یا اسم کتگوری و برند رو گرفت

این پکیج فقط برای سه نوع از صفحه های دیجی کالا کار میکنه و فقط برای کتگوری موبایل و لپتاپ کار میکنه. در بقیه موارد ممکنه خطا بده یا خروجی اشتباه تولید کنه

۱- صفحه اختصاصی محصول
۲- صفحه کتگوری (بدون اعمال فیلتر)
۳- صفحه کتکوری با برند کالا

### صحفه اختصاصی محصول

در صورتی که آدرس برای یه دونه محصول باشه (تشخیص این کار با پکیج api_digikala انجام میشه) اول داخل دیتابیس میگرده و اگه محصول رو پیدا کرد اونو سریالیز میکنه و به کاربر میده
اگه پیدا نکرد با پکیج api_digikala دیتای اونو از دیجی کالا میگیره و توی دیتابیس ذخیره میکنه و به کاربر نشون میده

نمونه آدرس:

```
https://www.digikala.com/product/dkp-9092242/%DA%AF%D9%88%D8%B4%DB%8C-%D9%85%D9%88%D8%A8%D8%A7%DB%8C%D9%84-%D8%B3%D8%A7%D9%85%D8%B3%D9%88%D9%86%DA%AF-%D9%85%D8%AF%D9%84-galaxy-a13-sm-a137fds-%D8%AF%D9%88-%D8%B3%DB%8C%D9%85-%DA%A9%D8%A7%D8%B1%D8%AA-%D8%B8%D8%B1%D9%81%DB%8C%D8%AA-64-%DA%AF%DB%8C%DA%AF%D8%A7%D8%A8%D8%A7%DB%8C%D8%AA-%D9%88-%D8%B1%D9%85-4-%DA%AF%DB%8C%DA%AF%D8%A7%D8%A8%D8%A7%DB%8C%D8%AA/
```

**امکاناتی که میشه اضافه کرد:**
توی این صفحه اطلاعات زیادی از محصول، محصولات مشابه و کامنت های مردم هست. میشه برای نظر سنجی استفاده کرد

### صفحه کتگوری (بدون اعمال فیلتر)

اگه آدرسی که به api داده میشه برای کتگوری باشه، فقط اطلاعات "منتخب محصولات و تخفیف و حراج" گرفته میشه

نمونه آدرس:

```
https://www.digikala.com/search/category-mobile-phone/
```

**امکاناتی که میشه اضافه کرد:**
این صفحه مثل ویترین هر کتگوریه، تمام حراج ها، پرفروش ها و بهترین های دیجی کالا اینجاس. میشه به راحتی اطلاعات خوبی از این صفحه بدست آورد

### صفحه کتگوری با برند

اگه صفحه کتگوری همراه با برند محصول باشه، تمام محصولات توی اون صفحه گرفته میشه

نمونه آدرس:

```
https://www.digikala.com/search/category-mobile-phone/apple/
```

**امکاناتی که میشه اضافه کرد:**
این صفحه تمام محصولات کتگوری و برند رو داره (مثلا موبایل های سامسونگ)، از اینجا میشه کل محصولات ذخیره شده توی دیجی کالا رو گرفت. صفحه اولش ۲۰ تا محصول داره ولی میشه بهش شماره صفحه داد و هرچی هست رو گرفت

---

### ویو

کلا یه ویو داره که متد POST رو قبول میکنه و یه گزینه میگیره

</font>

```json
{
  "url": "a digikala page url"
}
```

<font dir="rtl">

ویو بر اساس نوع آدرسی که بهش داده میشه

---

### ماژول utils.py

این ماژول چند تا تابع کمکی برای ویو داره که اطلاعاتی که برای ذخیره توی دیتابیس نیازه رو از خروجی api_digikala.get_url_cleaned_data رو تمیز میکنه

---

### سریالایزر ها

دو تا سریالایزر برای برای سریالایز کردن محصولات(موقعی که محصول داخل دیتابیس هست) ساتفاده میشه. توی بقیه حالت ها مستقیم از دیتای گرفته شده از api_digikala استفاده میشه

</font>
